# Gitleaks configuration per secret scanning
# Rileva credenziali, API keys, token e altri secrets nel codice

title = "MyPlanner Secret Scanning"

[extend]
# Usa regole predefinite di Gitleaks
useDefault = true

# Regole personalizzate per pattern specifici del progetto
[[rules]]
id = "myplanner-secret-key"
description = "SECRET_KEY hardcoded"
regex = '''(?i)(secret[_-]?key|SECRET[_-]?KEY)\s*=\s*["']([^"']{20,})["']'''
tags = ["secret", "key", "jwt"]

[[rules]]
id = "myplanner-database-password"
description = "Database password hardcoded"
regex = '''(?i)(password|PASSWORD)\s*[:=]\s*["']([^"']{8,})["']'''
tags = ["database", "password"]

[[rules]]
id = "myplanner-api-key"
description = "API key hardcoded"
regex = '''(?i)(api[_-]?key|API[_-]?KEY)\s*[:=]\s*["']([^"']{20,})["']'''
tags = ["api", "key"]

# Escludi file che possono contenere pattern falsi positivi
[allowlist]
description = "Files to exclude from scanning"
paths = [
    '''\.env\.example''',
    '''env\.example''',
    '''docker-compose\.env\.example''',
    '''\.git/''',
    '''node_modules/''',
    '''__pycache__/''',
    '''\.pytest_cache/''',
    '''\.venv/''',
    '''venv/''',
    '''dist/''',
    '''build/''',
    '''\.next/''',
    '''coverage/''',
    '''\.coverage''',
    '''\.md$''',
    '''\.txt$''',
    '''\.json$''',
    '''\.lock$''',
    '''\.log$''',
]

# Commit da ignorare (es. commit di migrazione con dati di esempio)
commits = [
    # Aggiungi hash commit da ignorare se necessario
]
